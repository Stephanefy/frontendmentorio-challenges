import {
  __toESM,
  require_react
} from "./chunk-C3URVCCN.js";

// node_modules/little-state-machine/dist/little-state-machine.es.js
var e = __toESM(require_react());
var t = function() {
  var e2 = { name: "__LSM__", middleWares: [], persist: "action" }, t2 = {};
  try {
    e2.storageType = "undefined" != typeof sessionStorage ? window.sessionStorage : void 0;
  } catch (e3) {
  }
  return { updateStore: function(n2) {
    try {
      t2 = e2.storageType && JSON.parse(e2.storageType.getItem(e2.name) || "") || n2;
    } catch (e3) {
      t2 = n2;
    }
  }, saveStore: function() {
    e2.storageType && e2.storageType.setItem(e2.name, JSON.stringify(t2));
  }, get state() {
    return t2;
  }, set state(e3) {
    t2 = e3;
  }, get options() {
    return e2;
  }, set options(t3) {
    e2 = t3;
  } };
}();
var n = e.createContext(void 0);
var o = function(o2) {
  var r2 = o2.children, s2 = e.useState(t.state), a2 = s2[0], i = s2[1];
  return e.useEffect(function() {
    "beforeUnload" === t.options.persist && (window.onbeforeunload = function() {
      return t.saveStore();
    }, t.options.storageType && t.options.storageType.removeItem(t.options.name));
  }, []), e.createElement(n.Provider, { value: { state: a2, setState: i } }, r2);
};
function r() {
  return r = Object.assign || function(e2) {
    for (var t2 = 1; t2 < arguments.length; t2++) {
      var n2 = arguments[t2];
      for (var o2 in n2)
        Object.prototype.hasOwnProperty.call(n2, o2) && (e2[o2] = n2[o2]);
    }
    return e2;
  }, r.apply(this, arguments);
}
function s(e2, n2) {
  n2 && (t.options = r({}, t.options, n2)), "undefined" != typeof window && (window.__LSM_NAME__ = t.options.name, window.__LSM_RESET__ = function() {
    return t.options.storageType && t.options.storageType.removeItem(t.options.name);
  }), t.updateStore(e2);
}
function a(o2) {
  var r2 = e.useContext(n), s2 = r2.state, a2 = r2.setState, i = e.useRef(Object.entries(o2 || {}).reduce(function(e2, n2) {
    var o3;
    return Object.assign({}, e2, ((o3 = {})[n2[0]] = function(e3, n3) {
      return function(o4, r3) {
        window.__LSM_NAME__ = n3.name, t.state = n3(t.state, o4), t.options.middleWares && (t.state = t.options.middleWares.reduce(function(e4, t2) {
          return t2(e4, n3.name, o4) || e4;
        }, t.state)), (!r3 || !r3.skipRender) && e3(t.state), "action" === t.options.persist && t.saveStore();
      };
    }(a2, n2[1]), o3));
  }, {}));
  return { actions: i.current, state: s2, getState: e.useCallback(function() {
    return t.state;
  }, []) };
}
export {
  o as StateMachineProvider,
  s as createStore,
  a as useStateMachine
};
//# sourceMappingURL=little-state-machine.js.map
